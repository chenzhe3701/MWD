% mFilter = vic2D_filter(filter_size)
%
% This function returns the decay filter that is used by Vic2D.
% The filters were numerically fitted.
% The rule for making this filter was not clear.
%
% chenzhe, 2017-10-16

function h = vic2D_filter(filter_size)
size_sigma = [
    5, 1.4105;
    7, 1.9747;
    9, 2.5389;
    11, 3.1031;
    13, 3.6675;
    15, 4.2316;
];  % the relationship is likely to be filter_size=3.5448*sigma

switch filter_size
    case 5
        h = [
            0.0124    0.0263    0.0339    0.0263    0.0124
            0.0263    0.0560    0.0720    0.0560    0.0263
            0.0339    0.0720    0.0925    0.0720    0.0339
            0.0263    0.0560    0.0720    0.0560    0.0263
            0.0124    0.0263    0.0339    0.0263    0.0124];
    case 7
        h = [
            0.0047    0.0090    0.0132    0.0150    0.0132    0.0090    0.0047
            0.0090    0.0170    0.0250    0.0285    0.0250    0.0170    0.0090
            0.0132    0.0250    0.0368    0.0418    0.0368    0.0250    0.0132
            0.0150    0.0285    0.0418    0.0475    0.0418    0.0285    0.0150
            0.0132    0.0250    0.0368    0.0418    0.0368    0.0250    0.0132
            0.0090    0.0170    0.0250    0.0285    0.0250    0.0170    0.0090
            0.0047    0.0090    0.0132    0.0150    0.0132    0.0090    0.0047];
    case 9
        h = [
            0.0024    0.0041    0.0061    0.0077    0.0083    0.0077    0.0061    0.0041    0.0024
            0.0041    0.0071    0.0105    0.0133    0.0143    0.0133    0.0105    0.0071    0.0041
            0.0061    0.0105    0.0155    0.0196    0.0211    0.0196    0.0155    0.0105    0.0061
            0.0077    0.0133    0.0196    0.0247    0.0267    0.0247    0.0196    0.0133    0.0077
            0.0083    0.0143    0.0211    0.0267    0.0288    0.0267    0.0211    0.0143    0.0083
            0.0077    0.0133    0.0196    0.0247    0.0267    0.0247    0.0196    0.0133    0.0077
            0.0061    0.0105    0.0155    0.0196    0.0211    0.0196    0.0155    0.0105    0.0061
            0.0041    0.0071    0.0105    0.0133    0.0143    0.0133    0.0105    0.0071    0.0041
            0.0024    0.0041    0.0061    0.0077    0.0083    0.0077    0.0061    0.0041    0.0024];
    case 11
        h = [
            0.0014    0.0023    0.0033    0.0043    0.0050    0.0053    0.0050    0.0043    0.0033    0.0023    0.0014
            0.0023    0.0037    0.0053    0.0068    0.0080    0.0084    0.0080    0.0068    0.0053    0.0037    0.0023
            0.0033    0.0053    0.0076    0.0098    0.0115    0.0121    0.0115    0.0098    0.0076    0.0053    0.0033
            0.0043    0.0068    0.0098    0.0128    0.0149    0.0157    0.0149    0.0128    0.0098    0.0068    0.0043
            0.0050    0.0080    0.0115    0.0149    0.0174    0.0183    0.0174    0.0149    0.0115    0.0080    0.0050
            0.0053    0.0084    0.0121    0.0157    0.0183    0.0193    0.0183    0.0157    0.0121    0.0084    0.0053
            0.0050    0.0080    0.0115    0.0149    0.0174    0.0183    0.0174    0.0149    0.0115    0.0080    0.0050
            0.0043    0.0068    0.0098    0.0128    0.0149    0.0157    0.0149    0.0128    0.0098    0.0068    0.0043
            0.0033    0.0053    0.0076    0.0098    0.0115    0.0121    0.0115    0.0098    0.0076    0.0053    0.0033
            0.0023    0.0037    0.0053    0.0068    0.0080    0.0084    0.0080    0.0068    0.0053    0.0037    0.0023
            0.0014    0.0023    0.0033    0.0043    0.0050    0.0053    0.0050    0.0043    0.0033    0.0023    0.0014];
    case 13
        h = [
            0.0010    0.0014    0.0020    0.0026    0.0031    0.0035    0.0036    0.0035    0.0031    0.0026    0.0020    0.0014    0.0010
            0.0014    0.0022    0.0030    0.0039    0.0047    0.0053    0.0055    0.0053    0.0047    0.0039    0.0030    0.0022    0.0014
            0.0020    0.0030    0.0042    0.0055    0.0066    0.0074    0.0076    0.0074    0.0066    0.0055    0.0042    0.0030    0.0020
            0.0026    0.0039    0.0055    0.0071    0.0085    0.0095    0.0099    0.0095    0.0085    0.0071    0.0055    0.0039    0.0026
            0.0031    0.0047    0.0066    0.0085    0.0103    0.0115    0.0119    0.0115    0.0103    0.0085    0.0066    0.0047    0.0031
            0.0035    0.0053    0.0074    0.0095    0.0115    0.0129    0.0133    0.0129    0.0115    0.0095    0.0074    0.0053    0.0035
            0.0036    0.0055    0.0076    0.0099    0.0119    0.0133    0.0138    0.0133    0.0119    0.0099    0.0076    0.0055    0.0036
            0.0035    0.0053    0.0074    0.0095    0.0115    0.0129    0.0133    0.0129    0.0115    0.0095    0.0074    0.0053    0.0035
            0.0031    0.0047    0.0066    0.0085    0.0103    0.0115    0.0119    0.0115    0.0103    0.0085    0.0066    0.0047    0.0031
            0.0026    0.0039    0.0055    0.0071    0.0085    0.0095    0.0099    0.0095    0.0085    0.0071    0.0055    0.0039    0.0026
            0.0020    0.0030    0.0042    0.0055    0.0066    0.0074    0.0076    0.0074    0.0066    0.0055    0.0042    0.0030    0.0020
            0.0014    0.0022    0.0030    0.0039    0.0047    0.0053    0.0055    0.0053    0.0047    0.0039    0.0030    0.0022    0.0014
            0.0010    0.0014    0.0020    0.0026    0.0031    0.0035    0.0036    0.0035    0.0031    0.0026    0.0020    0.0014    0.0010];
    case 15
        h = [
            0.0007    0.0010    0.0013    0.0017    0.0021    0.0024    0.0026    0.0026    0.0026    0.0024    0.0021    0.0017    0.0013    0.0010    0.0007
            0.0010    0.0014    0.0019    0.0024    0.0030    0.0034    0.0037    0.0038    0.0037    0.0034    0.0030    0.0024    0.0019    0.0014    0.0010
            0.0013    0.0019    0.0026    0.0033    0.0040    0.0046    0.0050    0.0052    0.0050    0.0046    0.0040    0.0033    0.0026    0.0019    0.0013
            0.0017    0.0024    0.0033    0.0043    0.0052    0.0060    0.0065    0.0067    0.0065    0.0060    0.0052    0.0043    0.0033    0.0024    0.0017
            0.0021    0.0030    0.0040    0.0052    0.0063    0.0072    0.0079    0.0081    0.0079    0.0072    0.0063    0.0052    0.0040    0.0030    0.0021
            0.0024    0.0034    0.0046    0.0060    0.0072    0.0083    0.0090    0.0093    0.0090    0.0083    0.0072    0.0060    0.0046    0.0034    0.0024
            0.0026    0.0037    0.0050    0.0065    0.0079    0.0090    0.0098    0.0101    0.0098    0.0090    0.0079    0.0065    0.0050    0.0037    0.0026
            0.0026    0.0038    0.0052    0.0067    0.0081    0.0093    0.0101    0.0104    0.0101    0.0093    0.0081    0.0067    0.0052    0.0038    0.0026
            0.0026    0.0037    0.0050    0.0065    0.0079    0.0090    0.0098    0.0101    0.0098    0.0090    0.0079    0.0065    0.0050    0.0037    0.0026
            0.0024    0.0034    0.0046    0.0060    0.0072    0.0083    0.0090    0.0093    0.0090    0.0083    0.0072    0.0060    0.0046    0.0034    0.0024
            0.0021    0.0030    0.0040    0.0052    0.0063    0.0072    0.0079    0.0081    0.0079    0.0072    0.0063    0.0052    0.0040    0.0030    0.0021
            0.0017    0.0024    0.0033    0.0043    0.0052    0.0060    0.0065    0.0067    0.0065    0.0060    0.0052    0.0043    0.0033    0.0024    0.0017
            0.0013    0.0019    0.0026    0.0033    0.0040    0.0046    0.0050    0.0052    0.0050    0.0046    0.0040    0.0033    0.0026    0.0019    0.0013
            0.0010    0.0014    0.0019    0.0024    0.0030    0.0034    0.0037    0.0038    0.0037    0.0034    0.0030    0.0024    0.0019    0.0014    0.0010
            0.0007    0.0010    0.0013    0.0017    0.0021    0.0024    0.0026    0.0026    0.0026    0.0024    0.0021    0.0017    0.0013    0.0010    0.0007];
    case 17
        h = [
            ];
        
    otherwise
end

end